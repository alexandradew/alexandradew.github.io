<!DOCTYPE html>
<html>
<head>
	<title>Ship Game</title>
	<style>
		body{
			background: #2c3e50;
			color:#FFF;
		}
		canvas{
			position: absolute;
			top:0;
			left:0;
			right:0;
			bottom:0;
			margin:auto;
			border:2px solid;
			background: #34495e;
		}

		#info{
			font-size:20px;
		}
			#meteor{
			font-size:20px;
		}
	</style>
</head>
<body>
<canvas width="600" height="800"></canvas>
<script>
	//variaveis

	var vidas = 3, 
	shipSPEED = 5,
	pontos = 0, 
	fireSPEED = 10
	shipLEFT = false, 
	shipRIGHT = false,
	fireUP = false,
	LEFT = 37, 
	RIGHT = 39

	//canvas

	var cnv = document.querySelector('canvas');
	var ctx = cnv.getContext('2d');

	// imagens

	var background = new Image();
	background.src = "bg.jpg";

	var shipIMG = new Image();
	shipIMG.src = "ship.png";

	var meteorIMG = new Image();
	meteorIMG.src = "meteor.png";

	var bulletIMG = new Image();
	bulletIMG.src = "bullet.png";

	//objects

	meteors=[
	{
		img:meteorIMG,
		x:Math.floor(Math.random() * 520) + 1,
		y:-40,
		w:40,
		h:60
	}
	];

	bullets = [];

	var ship = {
		img:shipIMG,
		x:150,
		y:540,
		w:50,
		h:60
	}

	function move(){
		// move listeners
			window.addEventListener("keydown", function keyDown(k){
			var key =	k.keyCode;
				if (key == LEFT && key != RIGHT){
					shipLEFT = true;
				}
				if (key == RIGHT && key != LEFT){
					shipRIGHT = true;
				}
			})

			window.addEventListener("keyup", function keyUp(k){
			var key =	k.keyCode;
				if (key == LEFT && key != RIGHT){
					shipLEFT = false;
				}
				if (key == RIGHT && key != LEFT){
					shipRIGHT = false;
				}
			})

			//ship movement
			if(shipLEFT){
				ship.x-=shipSPEED;
			}
			if(shipRIGHT){
				ship.x+=shipSPEED;
			}

			//limits
			if(ship.x <= 0){
				ship.x = 0;
			}
			if(ship.x >= 600-ship.w){
				ship.x = 600-ship.w;
			}

			if(fireUP){
				bullets.forEach( function(value,i,array){
				bullets[i].y-=4;
				})
			}
	}

			
		

	function fire(){
		window.addEventListener("keydown", function fire(k){
			var key = k.keyCode;
			if(key == 65){
				side = Math.floor(Math.random() * 2) + 1
					bullets.push({
					x:ship.x+17,
					y:ship.y+35,
					w:5,
					h:15
					})
				fireUP = true
				}
			})



	bullets.forEach(function(value,i,array){
			ctx.fillRect(bullets[i].x, bullets[i].y, bullets[i].w,bullets[i].h);
		})
	}
	

	
	
		

	



	function main(){
		requestAnimationFrame(main, cnv);
		render();
		move();
		fire();
	}

	main();


	function render(){
		ctx.drawImage(background,0,0)
		ctx.drawImage(ship.img,ship.x,ship.y,ship.w,ship.h)
	}
</script>
<body>
</body>